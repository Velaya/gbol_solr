<?xml version="1.0" encoding="UTF-8" ?>
<schema name="example" version="1.5">
  <types>
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" />
    <fieldType name="int" class="solr.TrieIntField" precisionStep="0" positionIncrementGap="0"/>	
    <fieldType name="tdate" class="solr.TrieDateField" precisionStep="6" positionIncrementGap="0"/>
    <fieldType name="tint" class="solr.TrieIntField" precisionStep="8" positionIncrementGap="0"/>
    <fieldType name="tfloat" class="solr.TrieFloatField" precisionStep="8" positionIncrementGap="0"/>
    <fieldType name="long" class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
    <fieldType name="tdouble" class="solr.TrieDoubleField" precisionStep="8" positionIncrementGap="0"/>
	<!-- Goe coordinates -->
	<!-- Old solr 3 based field type. Depricated and not used in this schema 
	<fieldType name="location_solr3" class="solr.LatLonType" subFieldSuffix="_coordinate"/> -->
    <fieldType name="location"  
	           class="solr.SpatialRecursivePrefixTreeFieldType"
               distanceUnits="degrees"
            />	
	<!-- If polygone support is neededn, add
    spatialContextFactory="com.spatial4j.core.context.jts.JtsSpatialContextFactory"	
	See http://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4 -->
 	
	
	
	<!-- A general text field that has reasonable, generic
         cross-language defaults: it tokenizes with StandardTokenizer,
	 removes stop words from case-insensitive "stopwords.txt"
	 (empty by default), and down cases.  At query time only, it
	 also applies synonyms. -->
    <fieldType name="text_species_names_with_synonyms" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.StandardTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory"/>
	<filter class="solr.SynonymFilterFactory" synonyms="Synonyms_common_names.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms_animals_common_names_de_en.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms_plants_common_names_de_en.txt" ignoreCase="true" expand="true"/>
      </analyzer>
    </fieldType>

    <fieldType name="text_general" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
	<tokenizer class="solr.StandardTokenizerFactory"/>
	<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
	<filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="query">
	<tokenizer class="solr.StandardTokenizerFactory"/>
	<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
	<filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldType>

	<!-- A text field that only splits on whitespace for exact matching of words -->
    <fieldType name="text_ws" class="solr.TextField" positionIncrementGap="100" autoGeneratePhraseQueries="true">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
	<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
	<filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/><filter class="solr.LowerCaseFilterFactory"/>
	<filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
	<filter class="solr.PorterStemFilterFactory"/>
      </analyzer>
      <analyzer type="query">
	<tokenizer class="solr.WhitespaceTokenizerFactory"/>
	<filter class="solr.SynonymFilterFactory" synonyms="Synonyms_common_names.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms_animals_common_names_de_en.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms_plants_common_names_de_en.txt" ignoreCase="true" expand="true"/>
      	<filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt"/>
	<filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="1"/>
	<filter class="solr.LowerCaseFilterFactory"/>
	<filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
	<filter class="solr.PorterStemFilterFactory"/>
      </analyzer>
    </fieldType>
 </types>	
    
 <fields>
   <field name="_version_" type="long" indexed="true" stored="true"/>
   
   <field name="id" type="string" indexed="true" stored="true" required="true" multiValued="false" /> <!-- tripplestoreid generated in data.config, line 14-->
   <field name="uuid" type="string" indexed="true" stored="true" required="true" multiValued="false" /> <!-- ID generated at index time. See solrconfig.xml, line 1058. Depricated -->
   <field name="fullScientificName" type="string" indexed="true" stored="true"  multiValued="false"/>
   <field name="scientificName" type="text_species_names_with_synonyms" indexed="true" stored="true"  multiValued="false"/>
   <field name="alternativeIdentifications" type="string" indexed="true" stored="true"  multiValued="true"/>
   <field name="recordURI" type="string" indexed="true" stored="true"/>
   <field name="guid" type="string" indexed="true" stored="true"/>
   <field name="rawidentificationid" type="int" indexed="true" stored="true"/>
   <field name="gatheringdate" type="string" indexed="true" stored="true" /> <!-- Some fields have an invalid date -->
   <field name="gatheringyear" type="int" indexed="true" stored="true" />
   <field name="country" type="string" indexed="true" stored="true"/>
   <field name="isocountrycode" type="string" indexed="true" stored="true"/>
   <field name="locality" type="text_general" indexed="true" stored="true"/>
   <field name="collectorname" type="string" indexed="true" stored="true"/>
   <field name="collectornumber" type="string" indexed="true" stored="true"/>
   <field name="fieldnumber" type="string" indexed="true" stored="true"/>
   <field name="longitude" type="string" indexed="true" stored="true"/>
   <field name="latitude" type="string" indexed="true" stored="true"/>
   <field name="epithet" type="string" indexed="true" stored="true"/>
   <field name="identifiername" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="collectioncode" type="string" indexed="true" stored="true"/>
   <field name="institutioncode" type="string" indexed="true" stored="true"/>
   <field name="parentInstitution" type="string" indexed="true" stored="true"/>
   <field name="unitid" type="string" indexed="true" stored="true"/>
   <field name="higherrank" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="highertaxon" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="genus" type="string" indexed="true" stored="true"/>

   <!-- Multimedia data -->
   <field name="mm_type" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="mm_url" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="mm_format" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="mm_copyrights" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="mm_termsofuse" type="string" indexed="true" stored="true" multiValued="true"/>
   <field name="mm_licenses" type="string" indexed="true" stored="true" multiValued="true"/>

   <field name="associationtype" type="string" indexed="true" stored="true"/>
   <field name="fk_tripleidstoreid1" type="string" indexed="true" stored="true"/> 
   <field name="fk_tripleidstoreid2" type="string" indexed="true" stored="true"/> 
   <field name="typestatus" type="string" indexed="true" stored="true"/>
   <field name="recordbasis" type="string" indexed="true" stored="true"/>
   
   <!-- harvesting info -->
   <field name="source_url" type="string" indexed="true" stored="true"/>
   <field name="last_harvested" type="tdate" indexed="true" stored="true" />   
   <field name="created_when" type="tdate" indexed="true" stored="true" />
   <field name="uddi_key" type="string" indexed="true" stored="true" />
   <field name="biocase_url" type="string" indexed="true" stored="true" />
   
   <!-- Geo Data -->
   <field name="geo_locality" type="location" indexed="true" stored="true"  /> 
   <!-- Type used to index the lat and long components for the "location" FieldType above  -->
   <dynamicField name="*_coordinate"  type="tdouble" indexed="true"  stored="false" />  
 
  
   <!-- Store only -->
   <field name="coordinateErrorDistanceInMeters" type="string" indexed="false" stored="true"/>
   <field name="coordinatesMethod" type="string" indexed="false" stored="true"/>
   <field name="verificationNotes" type="string" indexed="false" stored="true"/> 
   
   <!-- catchall field, containing all other searchable text fields (implemented
        via copyField further on in this schema  -->
   <field name="text" type="text_species_names_with_synonyms" indexed="true" stored="false" multiValued="true"/>
   <field name="autocomplete" type="text_species_names_with_synonyms" indexed="true" stored="true" multiValued="true"/>
 </fields>

  <!-- defaults -->
  <!-- use the tripplestore id stored in field id as unique key -->
  <uniqueKey>id</uniqueKey>
  <defaultSearchField>text</defaultSearchField>
  <solrQueryParser defaultOperator="AND"/>

  <!-- Fields for full text search -->
  <copyField source="country" dest="text"/>
  <copyField source="locality" dest="text"/>
  <copyField source="fullScientificName" dest="text"/>
  <copyField source="alternativeIdentifications" dest="text"/>
  <copyField source="collectorname" dest="text"/>
  <copyField source="highertaxon" dest="text"/>
  <copyField source="collectornumber" dest="text"/>
  <copyField source="institutioncode" dest="text"/>
  <copyField source="unitid" dest="text"/>
  <copyField source="id" dest="text"/>
  <copyField source="fieldnumber" dest="text"/>
  <copyField source="gatheringyear" dest="text"/>
  <copyField source="isocountrycode" dest="text"/>
  <copyField source="recordURI" dest="text"/>
  <copyField source="unitid" dest="text"/>
  <copyField source="guid" dest="text"/>

  <!-- content for autocomplete -->
  <copyField source="scientificName" dest="autocomplete"/>
  <copyField source="identifiername" dest="autocomplete"/>
  <copyField source="collectorname" dest="autocomplete"/>
  <copyField source="collectioncode" dest="autocomplete"/>
  <copyField source="country" dest="autocomplete"/>
  <copyField source="locality" dest="text"/>
</schema>
